# systemPatterns.md

## システム構成・設計パターン

- 設定ファイル（YAML）→値取得ロジック→出力（JSON/YAML）というシンプルなパイプライン
- openpyxlのdata_onlyモードで計算後の値を取得
- コマンドライン引数で設定ファイル・出力ファイルを指定可能
- 拡張性を考慮し、出力フォーマット追加やエラー処理をモジュール化
- 設定ファイル（YAML）でシート名または`*N`（左からN番目のシート）指定が可能な柔軟な値取得パターンを採用
- main.pyのget_excel_values関数で`*N`記法を判定し、シートリストからインデックスで選択する実装
- シート名に`*`が使えないExcel仕様を活用し、記法の衝突を回避
- エラー処理：範囲外や不正な`*N`指定はValueErrorで明示的に例外化
- `*N`記法の自動テスト（test_main.py）でシート順指定の動作を検証

## 主要コンポーネント
- main.py: エントリーポイント、全体の制御
- 設定ファイルパーサー
- Excel値取得モジュール
- 出力モジュール

## 重要な実装パス
- 設定ファイルのバリデーション
- Excelファイルの安全な読み込み
- 取得値の型変換・整形
