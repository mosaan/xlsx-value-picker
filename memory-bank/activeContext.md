# activeContext.md

## 現在の作業フォーカス
- Memory Bankの初期作成
- プロジェクト要件・設計・技術文書の整備
- main.pyの`--output`未指定時は標準出力に出力する仕様追加・README反映

## 直近の変更
- Memory Bankコアファイルの新規作成
- main.pyでExcelファイルパスを位置引数（第一引数）で指定できるように変更
- get_excel_values関数のpytestテスト（test_main.py）を作成し、正常動作を確認
- テストフレームワークpytestを開発用依存として`uv add pytest --dev`で導入
- テスト実行は`uv run pytest`で行う運用に統一
- シート指定で`*N`（例: `*2`）と記載した場合、左からN番目（1始まり）のシートを選択できる機能をmain.pyに実装
- READMEに`*N`指定の使い方・例を追記
- `*N`指定のテストケース追加（test_main.pyにて*1, *2でのシート値取得を検証）
- テスト全件パスを確認
- main.pyの`--output`未指定時は標準出力に出力する仕様に修正
- READMEのコマンド例・説明を修正

## 次のステップ（完了したら削除）
- main.pyのさらなる堅牢化（例: エラー処理やYAML出力対応）
- ドキュメント（READMEやサンプル）整備
- 必要に応じて追加テストやCI連携
- ユーザーからの追加要望・フィードバック対応

## アクティブな意思決定・考慮事項
- openpyxlのdata_onlyモードを利用
- uv addによるパッケージ管理徹底
- Memory Bankドキュメント駆動開発を徹底
- テストはpytest＋uv run pytestで実施
- Excel式セルの値取得はopenpyxlの仕様（保存時のみ値が埋まる）に依存
- `*N`記法はExcelの仕様上シート名と競合しないため安全
- シート数を超える・0以下の指定はエラーとして明示的に処理
- `--output`未指定時は標準出力に出力することでCLIツールとしての柔軟性を向上

## 学び・インサイト
- Memory Bankを活用したドキュメント駆動開発の重要性
- uvのdev依存・テスト実行フローの明文化で開発効率・再現性が向上
- シート順指定はユーザー利便性向上に有効
- ドキュメント・実装の一貫性維持が重要
- CLIツールは標準出力対応でスクリプト連携性が高まる
