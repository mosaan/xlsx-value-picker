# xlsx-value-picker プロジェクト現状と作業計画

## 1. 現状の概要

xlsx-value-pickerプロジェクトは、Excelファイルからの値取得、バリデーション、および様々な形式での出力機能を提供することを目的としています。現在のプロジェクト状況は以下の通りです：

### 1.1 ドキュメント整備状況

- 要件定義書 (`requirements.md`): 作成済み
- CLIインターフェース仕様 (`cli-spec.md`): 作成済み
- ディレクトリ構造定義 (`directory-structure.md`): 作成済み
- 技術選定ドキュメント (`technology-selection.md`): 作成済み
- プロジェクト現状文書 (`project-status.md`): 作成済み
- バリデーション設計ドキュメント (`validation-design.md`): 作成済み
- Mermaidスタイルガイド (`mermaid-style-guide.md`): 作成済み

### 1.2 実装状況

- 基本的なCLIフレームワーク: 実装済み（ただし仕様に完全には一致していない）
- Excelファイルからの値取得機能: 一部実装済み
- YAML/JSON出力機能: 実装済み（ただし仕様に完全には一致していない）
- Jinja2テンプレートによる出力機能: 実装済み（ただし仕様に完全には一致していない）
- バリデーション機能: **未実装**（設計は完了）

### 1.3 現状の課題

1. ドキュメントと実装の不一致
   - CLIインターフェース仕様と実際の実装が完全に一致していない。また、技術選定で検討した`Click`ライブラリを使用していない。
   - 要件定義書に記載されたバリデーション機能が未実装

2. テスト整備の不足
   - 単体テストが一部のみ実装されている状態
   - 統合テスト・E2Eテストが未整備

3. ユーザー向けドキュメントの不足
   - インストール方法の詳細説明
   - 設定ファイルの記述例
   - 使い方のチュートリアル

## 2. 作業計画

以下の順序でプロジェクトを進めていきます：

### フェーズ1: ドキュメント完備と実装の方針確定（現在）

- [x] 基本的なドキュメント整備
- [x] プロジェクトの現状と計画の文書化（本ドキュメント）
- [x] 実装方針の詳細検討と文書化（バリデーション設計ドキュメント、Mermaidスタイルガイド）
- [ ] スキーマ定義の見直し・拡充

### フェーズ2: コードベースの見直しと再構築

- [ ] 現在のコードベースの全体見直し
- [ ] CLIインターフェース実装の修正・仕様との整合性確保
- [ ] テスティングフレームワークの整備
- [ ] コア機能のテストカバレッジ向上

### フェーズ3: バリデーション機能の実装

- [x] バリデーションエンジンの設計と実装計画
- [ ] ルール定義のパーサーの実装
- [ ] 各種ルール（compare, required, any_of, all_of, not, regex_match, enum）の実装
- [ ] バリデーション結果の出力機能

### フェーズ4: ユーザビリティ向上

- [ ] エラーメッセージの改善
- [ ] ユーザードキュメントの整備
- [ ] サンプルおよびチュートリアルの作成
- [ ] READMEの充実

### フェーズ5: リリースと継続的改善

- [ ] バージョン管理の徹底
- [ ] CI/CDパイプラインの整備
- [ ] リリースプロセスの確立
- [ ] フィードバックの収集と継続的な改善

## 3. 次のタスク

短期的に着手するタスクは以下の通りです：

1. **バリデーション機能の実装開始**
   - バリデーションエンジンの基本構造の実装
   - ルールクラス階層の実装
   - 単純なルール（Compare, Required）から実装開始

2. **CLIインターフェースの見直し**
   - CLIインターフェース仕様と実装の不整合解消
   - コマンドラインオプションの整理
   - ヘルプメッセージの充実

3. **テスト環境整備**
   - バリデーション機能のテストケース作成
   - サンプルExcelとルール定義の準備
   - テスト自動化の整備

## 4. 注意事項

- **ドキュメントと実装の不一致**: 現時点ではドキュメントの内容と実装に不一致がある点に注意が必要です。特に要件定義に記載されたバリデーション機能については、今後実装を進める予定です。

- **ドキュメント間の整合性維持**: 複数のドキュメントで同じ内容を記述している箇所があるため、更新時は関連するすべてのドキュメントを確認し、整合性を保つことが重要です。

- **Mermaid図表の構文**: ドキュメント内のMermaid図表を編集する際は、`mermaid-style-guide.md`に記載されているガイドラインを遵守してください。

- **API安定性**: 初期バージョンのリリースまではAPIの変更が頻繁に行われる可能性があります。

- **依存関係管理**: 依存パッケージのバージョン固定が必要です。

## 5. 今後の展望

- GUIによるルール定義支援ツールの開発
- Webインターフェースの提供
- 他のスプレッドシート形式（CSV、Google Spreadsheetsなど）への対応
- プラグインシステムによる拡張性の向上
- ルールのリアルタイム検証機能の提供（Excel VBAとの連携など）

---

最終更新日: 2025年4月19日